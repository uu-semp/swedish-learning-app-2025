<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Summary</title>
    <!-- Global style guide (must come first) -->
    <link rel="stylesheet" href="../style.css?v=20251009" />
    <!-- Page-specific styles -->
    <link rel="stylesheet" href="styles/summary.css?v=20251009"/>
</head>
<body>
    <main>
        <section class="summary-card">
            <h1> Game Summary</h1>
            <p style="color:#555; margin-bottom: 24px; font-size:1.15rem;">
                Congratulations! You have completed the game.
            </p>
            <div class="summary-content">
                <div class="item">
                    <span>Level</span>
                    <strong id="a-level">-</strong>
                </div>
                <div class="item">
                    <span>Correct answers</span>
                    <strong id="a-score">0</strong>
                </div>
            </div>
            <nav class="actions">
                <a class="btn" href="index.html"><i class="fas fa-home"></i> Main Menu</a>
                <a class="btn" href="#" id="play-again-btn"><i class="fas fa-redo"></i> Play Again</a>
            </nav>
        </section>
    </main>
    <!-- Font Awesome for icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/js/all.min.js"></script>
    <!-- Remove any injected index.css when embedded via iframe -->
    <script>
        (function() {
            const links = Array.from(document.querySelectorAll('link[rel="stylesheet"]'));
            links.forEach(link => {
                const href = (link.getAttribute('href') || '').toLowerCase();
                if (href.endsWith('/index.css') || href.endsWith('index.css')) {
                    if (link.parentNode) {
                        link.parentNode.removeChild(link);
                    }
                }
            });
        })();
    </script>
    <!-- Script to populate summary with actual game data -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get stored game data
            const score = localStorage.getItem('gameScore');
            const level = localStorage.getItem('gameLevel');
            
            // Debug: log what we found
            console.log('Retrieved from localStorage - Score:', score, 'Level:', level);
            console.log('All localStorage keys:', Object.keys(localStorage));
            
            // Update the summary display
            if (score !== null && level !== null) {
                document.getElementById('a-score').textContent = score;
                document.getElementById('a-level').textContent = level;
                
                // Set the "Play Again" link based on the completed level
                const playAgainBtn = document.getElementById('play-again-btn');
                if (level === 'Level 1') {
                    playAgainBtn.href = './level1.html';
                } else if (level === 'Level 2') {
                    playAgainBtn.href = './level2.html';
                } else if (level === 'Level 3') {
                    playAgainBtn.href = './level3.html';
                } else {
                    // Default to level 1 if level is unknown
                    playAgainBtn.href = './level1.html';
                }
                
                // Clear the stored data after displaying
                localStorage.removeItem('gameScore');
                localStorage.removeItem('gameLevel');
            } else {
                // If no game data found, show a message or redirect
                document.getElementById('a-score').textContent = '0';
                document.getElementById('a-level').textContent = 'No game completed';
                document.getElementById('play-again-btn').href = './level1.html'; // Default to level 1
                console.log('No game data found in localStorage. User may have accessed summary directly.');
            }
        });
        
        // Temporary test function for debugging
        function testGameCompletion() {
            localStorage.setItem('gameScore', '3');
            localStorage.setItem('gameLevel', 'Level 1');
            console.log('Test data stored in localStorage');
            // Reload the page to see the changes
            location.reload();
        }
    </script>
    
</body>
</html>