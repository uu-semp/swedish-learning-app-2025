<!doctype html>

<!--
=================================================
Owned by Team 11
=================================================
-->

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grocery shopping!</title>
  <link rel="stylesheet" href="../style.css" />

  <script src="../scripts/vocabulary.js"></script>
  <script src="../scripts/save.js"></script>

  <!-- You are allowed to use JQuery and Vue.js but don't have to. They just make a
  lot of things easier
  -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"> 
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

  <!-- Site specific scripts and styles -->
  <link rel="stylesheet" href="index.css" />
  <script>window.vocabulary.load_team_data(11);</script>
  <script type="module" src="data.js" defer></script>
</head>
<body>
  <header>
    <h1>Team 11</h1>
  </header>

  <!-- TODO: Remove this div and it's content -->
  <div>
      <hr>
      <h2>A basic section to make sure that everything works for everyone</h2>

      <p>Font awesome is working: <i class="fa-solid fa-check"></i> (A checkmark should be visible)</p>

      <button id="check-jquery">Check if Javascript and JQuery is working</button> (Clicking the button should show an alert)

      <button id="check-saving">Click this button to see if saving works</button>
      <hr>
  </div>

  <main class="game-frame">
    <!-- All images are inside game-frame -->
    <img src="../team11/assets/paper.png" alt="Paper" class="paper">
    <img src="../team11/assets/character.png" alt="Character" class="character">
    <img src="../team11/assets/ShoppingCart.png" alt="Shopping Cart" class="cart">
    <img src="../team11/assets/shelf.png" alt="Shelf" class="shelf">
    <section class="popup-frame-wrap">
      <iframe
        src="./popup.html"
        title="Popup UI"
        class="popup-frame"
        loading="lazy"
        referrerpolicy="no-referrer"
        id="popupFrame">
      </iframe>
    </section>
    <div class="top-right-controls">
      <div class="status-bar" id="statusBar">
        <span id="progressPill">0 / 10 klara</span> |
        <span id="firstTryPill">Rätt: 0</span> |
        <span id="mistakesPill">Misstag: 0</span> |
        <span id="targetPill">Tröskel: 8 / 10</span>
      </div>
      <div class="demo-buttons">
        <button id="demoCorrect">Simulera Rätt</button>
        <button id="demoWrong">Simulera Fel</button>
        <button id="demoReset">Reset</button>
      </div>
    </div>
    <div class="chatbubble-toasts">
      <!-- Chatbubble toasts go here -->
    </div>
  </main>
  

  <footer>
    <small>Created as part of the "Software Engineering and Project Management" course 2025</small>
  </footer>

  <script>
  // Wait for DOM and iframe to be ready
  window.addEventListener('DOMContentLoaded', function() {
    const frame = document.getElementById('popupFrame');
    function postToPopup(type) {
      frame.contentWindow.postMessage({ type }, '*');
    }
    document.getElementById('demoCorrect').onclick = function() { postToPopup('demoCorrect'); };
    document.getElementById('demoWrong').onclick = function() { postToPopup('demoWrong'); };
    document.getElementById('demoReset').onclick = function() { postToPopup('demoReset'); };

    // Listen for status updates from popup
    window.addEventListener('message', function(event) {
      if (!event.data || event.data.type !== 'statusUpdate') return;
      const s = event.data.status;
      if (!s) return;
      document.getElementById('progressPill').textContent = s.progress;
      document.getElementById('firstTryPill').textContent = s.firstTry;
      document.getElementById('mistakesPill').textContent = s.mistakes;
      document.getElementById('targetPill').textContent = s.target;
    });
  });
  </script>
</body>
</html>
